!function(a,b){"function"==typeof define&&define.amd?define(["jquery","underscore"],b):a.veronica=b(a.$,a._)}(this,function(a,b){var c,d,e;return function(a){function b(a,b){return v.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=b&&b.split("/"),p=t.map,q=p&&p["*"]||{};if(a){for(a=a.split("/"),g=a.length-1,t.nodeIdCompat&&x.test(a[g])&&(a[g]=a[g].replace(x,"")),"."===a[0].charAt(0)&&o&&(n=o.slice(0,o.length-1),a=n.concat(a)),k=0;k<a.length;k++)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(0===k||1===k&&".."===a[2]||".."===a[k-1])continue;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}if((o||q)&&p){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),o)for(l=o.length;l>0;l-=1)if(e=p[o.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&q&&q[d]&&(i=q[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(b,c){return function(){var d=w.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),o.apply(a,d.concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){r[a]=b}}function j(c){if(b(s,c)){var d=s[c];delete s[c],u[c]=!0,n.apply(a,d)}if(!b(r,c)&&!b(u,c))throw new Error("No "+c);return r[c]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return a?k(a):[]}function m(a){return function(){return t&&t.config&&t.config[a]||{}}}var n,o,p,q,r={},s={},t={},u={},v=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;p=function(a,b){var c,d=k(a),e=d[0],g=b[1];return a=d[1],e&&(e=f(e,g),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(g)):f(a,g):(a=f(a,g),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},q={require:function(a){return g(a)},exports:function(a){var b=r[a];return"undefined"!=typeof b?b:r[a]={}},module:function(a){return{id:a,uri:"",exports:r[a],config:m(a)}}},n=function(c,d,e,f){var h,k,m,n,o,t,v,w=[],x=typeof e;if(f=f||c,t=l(f),"undefined"===x||"function"===x){for(d=!d.length&&e.length?["require","exports","module"]:d,o=0;o<d.length;o+=1)if(n=p(d[o],t),k=n.f,"require"===k)w[o]=q.require(c);else if("exports"===k)w[o]=q.exports(c),v=!0;else if("module"===k)h=w[o]=q.module(c);else if(b(r,k)||b(s,k)||b(u,k))w[o]=j(k);else{if(!n.p)throw new Error(c+" missing "+k);n.p.load(n.n,g(f,!0),i(k),{}),w[o]=r[k]}m=e?e.apply(r[c],w):void 0,c&&(h&&h.exports!==a&&h.exports!==r[c]?r[c]=h.exports:m===a&&v||(r[c]=m))}else c&&(r[c]=e)},c=d=o=function(b,c,d,e,f){if("string"==typeof b)return q[b]?q[b](c):j(p(b,l(c)).f);if(!b.splice){if(t=b,t.deps&&o(t.deps,t.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?n(a,b,c,d):setTimeout(function(){n(a,b,c,d)},4),o},o.config=function(a){return o(a)},c._defined=r,e=function(a,c,d){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");c.splice||(d=c,c=[]),b(r,a)||b(s,a)||(s[a]=[a,c,d])},e.amd={jQuery:!0}}(),e("../node_modules/almond/almond",function(){}),!function(a){function b(){this._events={},this._conf&&c.call(this,this._conf)}function c(b){b?(this._conf=b,b.delimiter&&(this.delimiter=b.delimiter),this._events.maxListeners=b.maxListeners!==a?b.maxListeners:j,b.wildcard&&(this.wildcard=b.wildcard),b.newListener&&(this.newListener=b.newListener),this.wildcard&&(this.listenerTree={})):this._events.maxListeners=j}function d(a){console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",a),console.trace&&console.trace()}function f(a){this._events={},this.newListener=!1,c.call(this,a)}function g(a,b,c,d){if(!c)return[];var e,f,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(e=0,f=c._listeners.length;e<f;e++)a&&a.push(c._listeners[e]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(g(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(g(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(g(a,b,c[h],n))),m=m.concat(g(a,b,c[h],d))):m=h===p?m.concat(g(a,b,c[h],d+2)):m.concat(g(a,b,c[h],d)));return m}m=m.concat(g(a,b,c[o],d+1))}if(i=c["*"],i&&g(a,b,i,d+1),j=c["**"])if(d<n){j._listeners&&g(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?g(a,b,j[h],d+2):h===o?g(a,b,j[h],d+1):(k={},k[h]=j[h],g(a,b,{"**":k},d+1)))}else j._listeners?g(a,b,j,n):j["*"]&&j["*"]._listeners&&g(a,b,j["*"],n);return m}function h(b,c){b="string"==typeof b?b.split(this.delimiter):b.slice();for(var e=0,f=b.length;e+1<f;e++)if("**"===b[e]&&"**"===b[e+1])return;for(var g=this.listenerTree,h=b.shift();h!==a;){if(g[h]||(g[h]={}),g=g[h],0===b.length)return g._listeners?("function"==typeof g._listeners&&(g._listeners=[g._listeners]),g._listeners.push(c),!g._listeners.warned&&this._events.maxListeners>0&&g._listeners.length>this._events.maxListeners&&(g._listeners.warned=!0,d(g._listeners.length))):g._listeners=c,!0;h=b.shift()}return!0}var i=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=10;f.EventEmitter2=f,f.prototype.delimiter=".",f.prototype.setMaxListeners=function(c){c!==a&&(this._events||b.call(this),this._events.maxListeners=c,this._conf||(this._conf={}),this._conf.maxListeners=c)},f.prototype.event="",f.prototype.once=function(a,b){return this.many(a,1,b),this},f.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},f.prototype.emit=function(){this._events||b.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return!1;var c,d,e,f,h,i=arguments.length;if(this._all&&this._all.length){if(h=this._all.slice(),i>3)for(c=new Array(i),f=0;f<i;f++)c[f]=arguments[f];for(e=0,d=h.length;e<d;e++)switch(this.event=a,i){case 1:h[e].call(this,a);break;case 2:h[e].call(this,a,arguments[1]);break;case 3:h[e].call(this,a,arguments[1],arguments[2]);break;default:h[e].apply(this,c)}}if(this.wildcard){h=[];var j="string"==typeof a?a.split(this.delimiter):a.slice();g.call(this,h,j,this.listenerTree,0)}else{if(h=this._events[a],"function"==typeof h){switch(this.event=a,i){case 1:h.call(this);break;case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:for(c=new Array(i-1),f=1;f<i;f++)c[f-1]=arguments[f];h.apply(this,c)}return!0}h&&(h=h.slice())}if(h&&h.length){if(i>3)for(c=new Array(i-1),f=1;f<i;f++)c[f-1]=arguments[f];for(e=0,d=h.length;e<d;e++)switch(this.event=a,i){case 1:h[e].call(this);break;case 2:h[e].call(this,arguments[1]);break;case 3:h[e].call(this,arguments[1],arguments[2]);break;default:h[e].apply(this,c)}return!0}if(!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},f.prototype.emitAsync=function(){this._events||b.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var c,d,e,f,h,i=[],j=arguments.length;if(this._all){if(j>3)for(c=new Array(j),f=1;f<j;f++)c[f]=arguments[f];for(e=0,d=this._all.length;e<d;e++)switch(this.event=a,j){case 1:i.push(this._all[e].call(this,a));break;case 2:i.push(this._all[e].call(this,a,arguments[1]));break;case 3:i.push(this._all[e].call(this,a,arguments[1],arguments[2]));break;default:i.push(this._all[e].apply(this,c))}}if(this.wildcard){h=[];var k="string"==typeof a?a.split(this.delimiter):a.slice();g.call(this,h,k,this.listenerTree,0)}else h=this._events[a];if("function"==typeof h)switch(this.event=a,j){case 1:i.push(h.call(this));break;case 2:i.push(h.call(this,arguments[1]));break;case 3:i.push(h.call(this,arguments[1],arguments[2]));break;default:for(c=new Array(j-1),f=1;f<j;f++)c[f-1]=arguments[f];i.push(h.apply(this,c))}else if(h&&h.length){if(j>3)for(c=new Array(j-1),f=1;f<j;f++)c[f-1]=arguments[f];for(e=0,d=h.length;e<d;e++)switch(this.event=a,j){case 1:i.push(h[e].call(this));break;case 2:i.push(h[e].call(this,arguments[1]));break;case 3:i.push(h[e].call(this,arguments[1],arguments[2]));break;default:i.push(h[e].apply(this,c))}}else if(!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(i)},f.prototype.on=function(a,c){if("function"==typeof a)return this.onAny(a),this;if("function"!=typeof c)throw new Error("on only accepts instances of Function");return this._events||b.call(this),this.emit("newListener",a,c),this.wildcard?(h.call(this,a,c),this):(this._events[a]?("function"==typeof this._events[a]&&(this._events[a]=[this._events[a]]),this._events[a].push(c),!this._events[a].warned&&this._events.maxListeners>0&&this._events[a].length>this._events.maxListeners&&(this._events[a].warned=!0,d(this._events[a].length))):this._events[a]=c,this)},f.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},f.prototype.addListener=f.prototype.on,f.prototype.off=function(b,c){function d(b){if(b!==a){var c=Object.keys(b);for(var e in c){var f=c[e],g=b[f];g instanceof Function||"object"!=typeof g||null===g||(Object.keys(g).length>0&&d(b[f]),0===Object.keys(g).length&&delete b[f])}}}if("function"!=typeof c)throw new Error("removeListener only takes instances of Function");var e,f=[];if(this.wildcard){var h="string"==typeof b?b.split(this.delimiter):b.slice();f=g.call(this,null,h,this.listenerTree,0)}else{if(!this._events[b])return this;e=this._events[b],f.push({_listeners:e})}for(var j=0;j<f.length;j++){var k=f[j];if(e=k._listeners,i(e)){for(var l=-1,m=0,n=e.length;m<n;m++)if(e[m]===c||e[m].listener&&e[m].listener===c||e[m]._origin&&e[m]._origin===c){l=m;break}if(l<0)continue;return this.wildcard?k._listeners.splice(l,1):this._events[b].splice(l,1),0===e.length&&(this.wildcard?delete k._listeners:delete this._events[b]),this.emit("removeListener",b,c),this}(e===c||e.listener&&e.listener===c||e._origin&&e._origin===c)&&(this.wildcard?delete k._listeners:delete this._events[b],this.emit("removeListener",b,c))}return d(this.listenerTree),this},f.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;c<d;c++)if(a===b[c])return b.splice(c,1),this.emit("removeListenerAny",a),this}else{for(b=this._all,c=0,d=b.length;c<d;c++)this.emit("removeListenerAny",b[c]);this._all=[]}return this},f.prototype.removeListener=f.prototype.off,f.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||b.call(this),this;if(this.wildcard)for(var c="string"==typeof a?a.split(this.delimiter):a.slice(),d=g.call(this,null,c,this.listenerTree,0),e=0;e<d.length;e++){var f=d[e];f._listeners=null}else this._events&&(this._events[a]=null);return this},f.prototype.listeners=function(a){if(this.wildcard){var c=[],d="string"==typeof a?a.split(this.delimiter):a.slice();return g.call(this,c,d,this.listenerTree,0),c}return this._events||b.call(this),this._events[a]||(this._events[a]=[]),i(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},f.prototype.listenerCount=function(a){return this.listeners(a).length},f.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof e&&e.amd?e("eventemitter",[],function(){return f}):"object"==typeof exports?module.exports=f:window.EventEmitter2=f}(),e("core/base",["jquery","underscore","eventemitter"],function(a,b,c){"use strict";var d={$:a,_:b,EventEmitter:c};return d.classBase={_call:function(a,b){a.apply(this,Array.prototype.slice.call(b))},_extend:function(c){var d=this;c.options&&a.extend(this._defaults,c.options),c.configs&&a.extend(this,c.configs),c.methods&&a.extend(this,c.methods),c.props&&this._extendMethod("_initProps",function(){b.each(c.props,function(a,b){d[b]=a})})},_extendMethod:function(a,b){var c=this[a];this[a]=function(){this._call(c,arguments),this._call(b,arguments)}}},d.whenSingleResult=function(){var c=Array.prototype.slice.call(arguments),d=a.Deferred();return a.when.apply(a,c).done(function(){var a=b.toArray(arguments),c=b.map(a,function(a){return b.isArray(a)&&"success"===a[1]?a[0]:a});d.resolve.apply(d,c)}).fail(function(){d.reject(arguments)}),d.promise()},d}),e("core/events",["underscore"],function(a){"use strict";var b={},c=[],d=(c.push,c.slice),e=(c.splice,b.Events={on:function(a,b,c){if(!g(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(b,c,d){if(!g(this,"once",b,[c,d])||!c)return this;var e=this,f=a.once(function(){e.off(b,f),c.apply(this,arguments)});return f._callback=c,this.on(b,f,d)},off:function(b,c,d){var e,f,h,i,j,k,l,m;if(!this._events||!g(this,"off",b,[c,d]))return this;if(!b&&!c&&!d)return this._events=void 0,this;for(i=b?[b]:a.keys(this._events),j=0,k=i.length;j<k;j++)if(b=i[j],h=this._events[b]){if(this._events[b]=e=[],c||d)for(l=0,m=h.length;l<m;l++)f=h[l],(c&&c!==f.callback&&c!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[b]}return this},trigger:function(a){if(!this._events)return this;var b=d.call(arguments,1);if(!g(this,"trigger",a,b))return this;var c=this._events[a],e=this._events.all;return c&&h(c,b),e&&h(e,arguments),this},stopListening:function(b,c,d){var e=this._listeningTo;if(!e)return this;var f=!c&&!d;d||"object"!=typeof c||(d=this),b&&((e={})[b._listenId]=b);for(var g in e)b=e[g],b.off(c,d,this),(f||a.isEmpty(b._events))&&delete this._listeningTo[g];return this}}),f=/\s+/,g=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(f.test(c)){for(var g=c.split(f),h=0,i=g.length;h<i;h++)a[b].apply(a,[g[h]].concat(d));return!1}return!0},h=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},i={listenTo:"on",listenToOnce:"once"};return a.each(i,function(b,c){e[c]=function(c,d,e){var f=this._listeningTo||(this._listeningTo={}),g=c._listenId||(c._listenId=a.uniqueId("l"));return f[g]=c,e||"object"!=typeof d||(e=this),c[b](d,e,this),this}}),e.bind=e.on,e.unbind=e.off,a.extend(b,e),e}),e("core/extend",[],function(a,b){"use strict";var c=function(a,b){var c,d=this;c=a&&_.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},_.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&_.extend(c.prototype,a),c.__super__=d.prototype,c};return c}),e("core/view",["jquery","underscore","./events","./extend"],function(a,b,c,d){"use strict";var e={$:a},f=e.View=function(a){this.cid=b.uniqueId("view"),a||(a={}),b.extend(this,b.pick(a,h)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},g=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes","className","tagName","events"];return b.extend(f.prototype,c,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof e.$?a:e.$(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=b.result(this,"events")))return this;this.undelegateEvents();for(var c in a){var d=a[c];if(b.isFunction(d)||(d=this[a[c]]),d){var e=c.match(g),f=e[1],h=e[2];d=b.bind(d,this),f+=".delegateEvents"+this.cid,""===h?this.$el.on(f,d):this.$el.on(f,h,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(b.result(this,"el"),!1);else{var a=b.extend({},b.result(this,"attributes"));this.id&&(a.id=b.result(this,"id")),this.className&&(a.class=b.result(this,"className"));var c=e.$("<"+b.result(this,"tagName")+">").attr(a);this.setElement(c,!1)}}}),f.extend=d,f}),e("core/history",["./events","./extend","jquery"],function(a,b,c){"use strict";var d={$:c},e=d.History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},f=/^[#\/]|\s+$/g,g=/^\/+|\/+$/g,h=/msie [\w.]+/,i=/\/$/,j=/#.*$/;return e.started=!1,_.extend(e.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(i,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(f,"")},start:function(a){if(e.started)throw new Error("Backbone.history has already been started");e.started=!0,this.options=_.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var b=this.getFragment(),c=document.documentMode,i=h.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);if(this.root=("/"+this.root+"/").replace(g,"/"),i&&this._wantsHashChange){var j=d.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=j.hide().appendTo("body")[0].contentWindow,this.navigate(b)}this._hasPushState?d.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?d.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b;var k=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&k.hash&&(this.fragment=this.getHash().replace(f,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){d.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),e.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b!==this.fragment&&(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),_.some(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!e.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(j,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),d.history=new e,d.history}),e("core/router",["underscore","./events","./extend","./history"],function(a,b,c,d){"use strict";var e={history:d},f=e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},g=/\((.*?)\)/g,h=/(\(\?)?:\w+/g,i=/\*\w+/g,j=/[\-{}\[\]+?.,\\\^$|#\s]/g;return a.extend(f.prototype,b,{initialize:function(){},route:function(b,c,d){a.isRegExp(b)||(b=this._routeToRegExp(b)),a.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var f=this;return e.history.route(b,function(a){var g=f._extractParameters(b,a);f.execute(d,g),f.trigger.apply(f,["route:"+c].concat(g)),f.trigger("route",c,g),e.history.trigger("route",f,c,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return e.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=a.result(this,"routes");for(var b,c=a.keys(this.routes);null!=(b=c.pop());)this.route(b,this.routes[b])}},_routeToRegExp:function(a){return a=a.replace(j,"\\$&").replace(g,"(?:$1)?").replace(h,function(a,b){return b?a:"([^/?]+)"}).replace(i,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(b,c){var d=b.exec(c).slice(1);return a.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}}),f.extend=c,f}),e("core/loader",["jquery"],function(a){"use strict";var b={};return b.useGlobalRequire=function(){return window.require?window.require:d},b.useGlobalRequirejs=function(){return window.requirejs?window.requirejs:c},b.require=function(c,d,e){var f=a.Deferred(),g=b.useGlobalRequire();return null==d&&(d=!0),d?(a.isArray(c)||(c=[c]),e&&g.config(e),g(c,function(){var a;a=1===arguments.length?arguments[0]:Array.prototype.slice.call(arguments),f.resolve(c,a)},function(a){console.error(a),f.reject(a)})):f.resolve(c,null),f.promise()},b}),e("core/logger",[],function(){"use strict";function a(a){return this.name=a||c,this._log=b,this._warn=b,this._error=b,this._info=b,this.time=b,this}!function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var b=function(){},c="veronica",d=window.console||{},e=function(){return(!Function.prototype.bind||Function.prototype.bind&&"undefined"==typeof window.addEventListener)&&"object"==typeof d&&"object"==typeof d.log},f={constructor:a,setName:function(a){return a||(a=c),this.name=a,this},enable:function(){if(this._log=d.log||b,this._info=d.info||this._info,this._warn=d.warn||this._log,this._error=d.error||this._log,this.time=this._time,Function.prototype.bind&&"object"==typeof d)for(var a=["log","warn","error"],c=0;c<a.length;c++)d[a[c]]=Function.prototype.call.bind(d[a[c]],d);return this},write:function(a,b){var c=Array.prototype.slice.call(b);c.unshift(this.name+":"),e()?a(c.join(" ")):a.apply(d,c)},log:function(){this.write(this._log,arguments)},warn:function(){this.write(this._warn,arguments)},error:function(){this.write(this._error,arguments)},info:function(){this.write(this._info,arguments)},_time:function(a,b){b||(b=""),d["time"+b](a)}};return a.prototype=f,a}),e("core/util",["underscore","jquery"],function(a,b){"use strict";function c(a,b){var c,d;for(d in b)c=b[d],a[d]=c;return a}function d(a,b){return c(a.prototype,b)}function e(a,b){a.prototype?d(a,b):c(a,b)}function f(a,b){b=b.replace(/\[(\w+)\]/g,".$1"),b=b.replace(/^\./,"");for(var c=b.split(".");c.length;){var d=c.shift();if(!(d in a))return;a=a[d]}return a}function g(a,b,c){b=b.replace(/\[(\w+)\]/g,".$1"),b=b.replace(/^\./,"");for(var d=b.split("."),e="o",f=a;d.length;){var g=d.shift();if(!(g in f||0===d.length))return;e+='["'+g+'"]',f=f[g]}e+="=v;",new Function("o, v",e)(a,c)}function h(a){a||(a=this);var b=a.toString().replace(i,"").replace(k,"").replace(j,""),c=b.slice(b.indexOf("(")+1,b.indexOf(")")).match(/([^\s,]+)/g);return null===c?[]:c}a.findIndex||a.mixin({findIndex:function(b,c){var d=a.indexOf;if(!a.isFunction(c))return d(b,c);for(var e=0;e<b.length;e++)if(c(b[e]))return e;return-1}}),a.safeInvoke||a.mixin({safeInvoke:function(a,b,c){var d=Array.slice.call(arguments,2);a&&a[b].apply(a,d)}});var i=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,j=/=[^,]+/gm,k=/=>.*$/gm;return{getParameterNames:h,decamelize:function(a,b){return b=void 0===b?"_":b,a.replace(/([A-Z])/g,b+"$1").toLowerCase()},camelize:function(a){return a.replace(/(?:^|[-_])(\w)/g,function(a,b){return b?b.toUpperCase():""})},extend:c,include:d,mixin:e,getter:f,setter:g,qsToJSON:function(a){a||(a=location.search.slice(1));var b=a.split("&"),c={};return b.forEach(function(a){a=a.split("="),c[a[0]]=decodeURIComponent(a[1]||"")}),JSON.parse(JSON.stringify(c))},donePromise:function(a){var c=b.Deferred();return c.resolve(a),c.promise()},failPromise:function(){var a=b.Deferred();return a.reject(),a.promise()},normalizePath:function(a){return a.replace("//","/").replace("http:/","http://")},mapArrayOrSingle:function(b,c){var d=a.isArray(b);d||(b=[b]);var e=a.map(b,c);return d?e:e[0]},ensureArray:function(b){return null==b?[]:(a.isObject(b)&&!a.isArray(b)&&(b=[b]),b)}}}),e("core/aspect",["underscore","jquery","exports"],function(a,b,c){"use strict";function d(a,b,c,d){for(var h,i,j=b.split(g);h=j.shift();)i=e(this,h),i.__isAspected||f.call(this,h),this.on(a+":"+h,c,d);return this}function e(a,b){var c=a[b];if(!c)throw new Error("Invalid method name: "+b);return c}function f(a){var b=this[a];this[a]=function(){var c=Array.prototype.slice.call(arguments),d=["before:"+a].concat(c);if(this.trigger.apply(this,d)!==!1){var e=b.apply(this,arguments),f=["after:"+a,e].concat(c);return this.trigger.apply(this,f),e}},this[a].__isAspected=!0}c.before=function(a,b,c){return d.call(this,"before",a,b,c)},c.after=function(a,b,c){return d.call(this,"after",a,b,c)};var g=/\s+/;a.mixin({aopBefore:function(a,b){return function(){var c=arguments,d=b.call(this,c);return d!==!1&&(d&&d.done?d.done(function(){a.apply(this,c)}).fail(function(){return!1}):a.apply(this,c))}},aopAfter:function(a,b){return function(){var c=a.apply(this,arguments);return c!==!1&&(c&&c.done?c.done(function(){b.apply(this,arguments)}).fail(function(){return!1}):b.apply(this,arguments))}}})}),e("core/querystring",["underscore"],function(a){function b(a){this.choice=a}function c(b){b||(b=location.search.slice(1));var c=b.split("&"),d={};return a.each(c,function(a){a=a.split("="),d[a[0]]=decodeURIComponent(a[1]||"")}),JSON.parse(JSON.stringify(d))}function d(a,b,c){var d=new RegExp("([?&])"+b+"=.*?(&|$)","i"),e=a.indexOf("?")!==-1?"&":"?";return a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+e+b+"="+c}var e={},e=b.prototype;return e._getUrl=function(){var a=this.choice;return 0===this.choice&&(a=window.location.search),1===this.choice&&(a=window.location.hash),a},e.set=function(b,c){var e=this._getUrl();a.isObject(b)?a.each(b,function(a,b){e=d(e,b,a)}):e=d(e,b,c),1==this.choice?window.location.hash=e:window.location.search=e},e.get=function(a){var b=this._getUrl();a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+a+"=([^&#]*)"),d=c.exec(b);return null===d?"":decodeURIComponent(d[1].replace(/\+/g," "))},e.toJSON=function(){var b,d=this._getUrl();0!==this.choice&&1!==this.choice&&(b=c(d));var e=c(window.location.search),f=/([^\?]*)\?([^\?]+)/.exec(d);null!=f&&(d="?"+f[2]);var g=c(d);return a.extend({},e,g,b)},function(a){return new b(a)}}),e("core/index",["./base","./events","./view","./history","./router","./loader","./logger","./util","./aspect","./querystring"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=a.EventEmitter,l=a.$,m=a._,n=l.extend({},a,{helper:{},View:c,Router:e,history:d,Events:b,constant:{DEFAULT_MODULE_NAME:"__default__",SCAFFOLD_LAYOUT_NAME:"scaffold",WIDGET_TYPE:"widget",WIDGET_CLASS:"ver-widget",WIDGET_TAG:"ver-tag",SANDBOX_REF_NAME:"__sandboxRef__"}}),o={};n.enums=o;var p={WIDGET:"widget",APP:"app"};n.enums.hostType=p,n.loader=f,n.util=h,n.aspect=i,n.getConfig=function(){var a=n.loader.useGlobalRequirejs(),b=a.s?a.s.contexts._.config:{sources:{}};return b.sources||(b.sources={}),function(){return b}}(),n.logger=new g,n.getConfig().debug&&n.logger.enable();var q=m.defaults(n.getConfig()||{},{wildcard:!0,delimiter:".",newListener:!0,maxListeners:50});return n.createMediator=function(){return new k(q)},n.mediator=new k(q),n.qs=j,n}),e("core/application",["./index"],function(b){"use strict";function c(a){var c=b.$,d={name:"app",extensions:[],modules:[],autoBuildPage:!1,features:["dialog","plugin","spa"],autoParseWidgetName:!1,releaseWidgetPath:"./widgets",widgetNamePattern:/(\w*)-?(\w*)-?(\w*)/,global:!0,plugins:{},homePage:"home",page:{defaultLayout:"default",defaultLayoutRoot:"v-render-body",defaultSource:"basic",defaultInherit:"_common"},widget:{defaultHost:".v-render-body"},defaultPage:"default",router:{pagePattern:"/?(.+)??(.+)"}};a=c.extend(!0,{},d,a||{});var e={_extensions:[],name:a.name,core:b,lang:{},config:a};c.extend(this,e)}var d={constructors:c,launch:function(c){var d=[],e=this;return c||(c={}),_.each(this.config.extensions,function(a){var c=b.loader.require(a,_.isString(a)).done(function(a,b){null==b&&(b=a),_.isFunction(b)&&e.use(b)});d.push(c)}),_.each(this.config.modules,function(a){e.module.add(a.name,a)}),a.when.apply(a,d).done(function(){c.parse&&e.parser.parse()})},stop:function(){this.sandbox.stop()},use:function(b){var d=this;return _.isArray(b)||(b=[b]),a.each(b,function(a,b){b(d,c)}),this},mixin:function(a,b){return null==b&&(b=!0),b?this.core.util.mixin(this,a):this.core.util.mixin(c,a),this},emit:function(){var a=Array.prototype.slice.call(arguments);a.push(this.name),this.sandbox.emit.apply(this.sandbox,a)}};return c.prototype=d,c}),e("app/provider",[],function(){return function(a){var b=a.core._.extend,c=(a.core.logger,a.core.util),d=a.core.classBase;a.providerBase=b({},d,{_pool:{},_defaultKey:"default",_nested:!1,_preprocess:function(a){return a},setDefault:function(a){this._defaultKey=a},get:function(a){a||(a=this._defaultKey);var b=this._nested?c.getter(this._pool,a):this._pool[a];return b},attach:function(a){this._pool=b({},this._pool,a)},add:function a(c,d,e){var f=this;if(_.isObject(c))e=d,_.each(c,function(b,c){a.call(f,c,b,e)});else{e=b({force:!1,inherit:"default"},e);var g=this.get(c);if(!g||e.force===!0){var h=this.get(e.inherit);_.isFunction(d)||(d=b({},h,d)),d.__id=c,d=f._preprocess(d),this._pool[c]=d}}}}),a.provider={create:function(c){var d=b({},a.providerBase,c);return d._pool={},d}},a.windowProvider=a.provider.create();var e=function(){};a.windowProvider.add("default",{options:function(a){return a},create:function(a,b,c){var d={element:a,core:null,config:b,open:e,close:e,destroy:e,center:e,setOptions:function(a){},rendered:function(a){},removeLoading:function(){}};return d}}),a.uiKitProvider=a.provider.create()}}),e("app/emitQueue",[],function(){"use strict";return function(a){a.core._,a.core.$;a.emitQueue={_emitQueue:[],empty:function(){for(var a=this._emitQueue;a.length>0;)a.shift()()},push:function(a){this._emitQueue.push(a)}}}}),e("app/env",[],function(){"use strict";return function(a){var b=a.core;a.core._,a.core.$;a.env={},a.env.isDebug=function(){return b.getConfig().debug===!0},a.env.getReleaseWidgetPath=function(){return a.config.releaseWidgetPath}}}),e("app/data",[],function(){return function(a){var b={_data:{},get:function(a){return this._data[a]},set:function(b,c,d){null==d&&(d=!0),this._data[b]=c,d&&a.sandbox.emit("change."+b,c)}};a.data=b}}),e("app/page",[],function(){return function(a){var b=a.core,c=a.core.$,d=a.core._;a.page=a.provider.create({_currPageName:"",_changeTitle:function(){},_getAllWidgetConfigs:function a(b,c,e){return null==c&&(c=this),null==e&&(e=[]),e.push(b.widgets),d.each(b.inherits,function(b){var d=c.get(b);e=a(d,c,e)}),e},isCurrent:function(a){var b=this.getCurrName();
return"default"===b||b===a},getCurrName:function(){return this._currPageName},setCurrName:function(a){this._currPageName=a},_load:function(e,f,g){var h,i=this,j=d.flatten(this._getAllWidgetConfigs(f)),k=this.getCurrName(),l=c.Deferred(),m=b.util.donePromise();return a.emit("pageLoading",e),(""===k||(h=this.get(k))&&h.layout!==f.layout)&&(m=a.layout.change(f.layout).done(function(){a.emit("layoutChanged",f.layout)}).fail(function(){l.reject()})),m.done(function(){i.setCurrName(e),a.sandbox.startWidgets(j,e).done(function(){a.widget.recycle(),a.emit("pageLoaded",e),l.resolve()})}),l.promise()},active:function(a){return a?this.change(a):a=this.getCurrName()},start:function(b){b&&a.layout.init(),a.router.start(),a.emit("appStarted")},resolve:function(d){var e=this.get(d),f=b.util.failPromise(),g=this;if(!e&&a.config.autoResolvePage){var h=page.build(d);if(h){var i={};i[d]=h,g.add(i),e=g.get(d)}if(!e){var j=d.replace("-","/");f=c.getJSON(j)}}return e&&(f=b.util.donePromise(e)),f.fail(function(){a.emit("pageNotFound",d)}),f},build:function(a){},change:function(a,b){var c=this;c.resolve(a).done(function(d){c._load(a,d,b)})}}),a.page.add("_common",{name:"_common",inherits:!1}),a.page.add("default",{name:"default",layout:"default",inherits:["_common"]})}}),e("app/layout",[],function(){"use strict";return function(a){var b=a.core._,c=a.core.$,d=a.core.constant;a.layout=a.provider.create({_preprocess:function(a){return b.isString(a)&&(a={html:a}),a},change:function(d){var e=a.core.util.donePromise(),f=c("."+a.config.page.defaultLayoutRoot);0===f.length&&(f=c("body")),b.each(f.find(".ver-widget"),function(b){a.widget.stop(c(b))});var g=this.get(d);return g?(a.emit("layoutChanging",d),g.url&&(e=c.get(g.url).done(function(a){g.html=a})),e.done(function(){f.html(g.html)}),e):a.core.util.donePromise()},init:function(){var a=this.get(d.SCAFFOLD_LAYOUT_NAME);a.html&&c("body").prepend(a.html)}}),a.layout.add(d.SCAFFOLD_LAYOUT_NAME,{html:'<div class="'+a.config.page.defaultLayoutRoot+'"></div>'})}}),e("app/module",[],function(){"use strict";return function(a){var b=(a.core,a.core._);a.module=a.provider.create(),a.module.add("default",{name:"default",path:"widgets",multilevel:!1,locationPattern:/(\w*)-?(\w*)-?(\w*)-?(\w*)-?(\w*)/,resolvePath:function(){var a=this.path;return a.replace("${name}",this.name)},resolveLocation:function(a){var c=this,d=a;if(c.multilevel===!0){var e=c.locationPattern.exec(a);d=b.reduce(e,function(a,b,d){return""===b?a:1===d?b===c.name?"":b:a+"/"+b})}return c.resolvePath()+"/"+d}})}}),e("core/sandbox",["./index"],function(a){"use strict";function b(a){this.name=a.name,this.app=a.app,this.type="sandbox",this._id=a._id,this._hostType=a._hostType,this._children=[],this._events=[]}var c=a._,d=(a.$,function(b){return function(d,e,f,g){var h=a.mediator;if(!c.isFunction(e)||!c.isString(d))throw new Error("Invalid arguments passed to sandbox."+b);f=f||this;var i=function(){var a=Array.prototype.slice.call(arguments),b=!0;if(f.options&&f.options.sandbox&&a.length>0&&a[0]._target){var c=a[0]._target,d=a[0]._senderId,g=f.sandbox.app,h=g.sandboxes.get(d),i=f.options.sandbox._id,j=[];b=!1,"children"===c&&(j=h.children()),"parents"===c&&(j=h.parents()),j.indexOf(i)>-1&&(b=!0)}b&&e.apply(f,a)};this._events=this._events||[],this._events.push({name:d,listener:e,callback:i,tag:g}),h[b](d,i)}}),e={constructor:b,log:function(b,d){if(d||(d="log"),a.logger.setName(this._hostType+"("+this.name+")"),c.isArray(b)){var e=[];e.push(b.shift()),e.push(b.shift()),e.push(b),a.logger[d].apply(a.logger,e)}else a.logger[d](b);a.logger.setName()},getConfig:a.getConfig,on:d("on"),once:d("once"),off:function(b,d){var e=a.mediator;this._events&&(this._events=c.reject(this._events,function(a){var c=a.name===b&&a.listener===d;return c&&e.off(b,a.callback),c}))},emit:function(){var b=a.mediator,d=a.app,e=Array.prototype.slice.call(arguments),f=c.bind(function(){e.length>1&&e[1]._target&&(e[1]._senderId=this._id),b.emit.apply(b,e),e.unshift("emitted"),this.log(e)},this);d.widget.isLoading?d.emitQueue.push(f):f()},stopListening:function(b){var d=a.mediator,e=this._events;this._events&&(b&&(e=c.filter(e,function(a){return a.tag===b})),c.each(e,function(a){d.off(a.name,a.callback)}))},startWidgets:function(b,d,e){var f=a.app;return f.widget.start(b,c.bind(function(a){var b=a.sandbox;b._parent=this._id,this._children.push({ref:b._id,caller:e})},this),d)},stop:function(){var b=a.app;b.widget.stop(this)},stopChildren:function(b){var d=this._children,e=a.app;b&&(d=c.filter(d,function(a){return a.caller===b})),c.invoke(c.map(d,function(a){return e.sandboxes.get(a.ref)}),"stop")},getHost:function(){},getOwner:function(){},children:function(a){null==a&&(a=[]);var b=this._children,d=this.app;if(null==b||0===b.length)return a;var e=c.map(b,function(a){return a.ref});return a=a.concat(e),c.each(e,function(b){var c=d.sandboxes.get(b);a=c.children(a)}),a},parents:function(){for(var a=this._parent,b=this.app,c=[];null!=a;){c.push(a);var d=b.sandboxes.get(a);a=d._parent}return c}};return b.prototype=e,b}),e("app/sandboxes",["../core/sandbox"],function(b){"use strict";return function(c){var d=c.core,e=d._,f=d.constant.SANDBOX_REF_NAME,g={_sandboxPool:{}};g.create=function(a,c){var f=e.uniqueId("sandbox$");c||(c=d.enums.hostType.WIDGET);var g=new b({name:a,_id:f,_hostType:c,app:d.app}),h=this._sandboxPool;if(h[f])throw new Error("Sandbox with ref "+f+" already exists.");return h[f]=g,g},g.remove=function(a){this._sandboxPool[a]=null,delete this._sandboxPool[a]},g.get=function(a){return this._sandboxPool[a]},g.getByName=function(a){return e.filter(this._sandboxPool,function(b){return b.name===a})},g.getByEl=function(b){var c=a(b).data(f);return this.get(c)},c.sandboxes=g}}),e("app/parser",[],function(){"use strict";return function(a){var b=(a.core._,a.core.$),c="data-ver-role",d={parse:function(d){d||(d="body");var e=[];b(d).find("["+c+"]").each(function(a,c){var d=b(c),f=d.data();f.options||(f.options={}),f.options.el=d,e.push({name:f.verRole,options:f.options})}),a.sandbox.startWidgets(e)},parseView:function(a,d){b(a.$el).find("["+c+"]").each(function(c,e){var f=b(e),g=f.data();g.options||(g.options={}),g.options.el=f,a.view(g.verRole,{name:g.verRole,initializer:d[g.verRole],options:g.options})})}};a.parser=d}}),e("app/router",[],function(){return function(b){var c,d=b.core._,e={};e.changePage=d.throttle(function(a,d){var e=c===d;if(c=d,b.page.isCurrent(a)){if(e)return;b.sandbox.emit("qs-changed",b.core.util.qsToJSON(d))}b.page.change(a,d)},500);var f={routes:{"(/)":"entry","(/)?*params":"entry","page=:page":"openPage","(/)*page":"openPage","(/)*page?*params":"openPage","widget/:widget@:source":"executeWidget"},initialize:function(){},entry:function(a){e.changePage(b.config.homePage,a)},executeWidget:function(a,c){b.sandbox.startWidgets({name:a,options:{_source:c||"default",host:b.config.page.defaultHost}})},openPage:function(a,b){e.changePage(a,b)}};return e.base=f,e.create=function(c){var d=b.core.Router.extend(a.extend(!0,{},e.base,c));return new d},e.start=function(a){var c=e.create(a);return e.instance=c,b.core.history.start({pushState:!1}),c},e.navigate=function(a,b){e.instance.navigate(a,b)},b.router=e,e}}),e("app/request",[],function(){return function(a){var b=a.core.$,c=a.core,d={};d.get=function(a,c){return b.get(a,c)},d.getJSON=function(a,c){return b.getJSON(a,c)},d.getComplex=function(a,c,d){return d||(d={}),b.ajax(b.extend({url:a,type:"GET",contentType:"application/json",data:JSON.stringify(c)},d))},d.post=function(a,c){return b.post(a,c)},d.postComplex=function(a,c,d){return b.ajax(b.extend({url:a,type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(c)},d))},d.getBundle=function(){var a=Array.prototype.slice.call(arguments),d=b.map(a,function(a){return _.isString(a)?b.get(a):a.done?a:b.get(a.url,a.data)});return c.whenSingleResult.apply(c,d)};var e=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("chrome")>=0&&window.externalHost};d.download=function(a){a||(a={}),void 0!=a.url&&(_.isString(a.data)||(a.data=b.param(a.data,!0)),e()?window.open(a.url+"?"+a.data,"newwindow"):(0===b("#global-download-iframe").length&&b('<iframe id="global-download-iframe" src="" style="width:0;height:0;display: inherit;border:0;" >').appendTo(document.body),b("#global-download-iframe").attr("src",a.url+"?"+a.data)))},a.request=d}}),e("app/qs",[],function(){return function(a){var b=(a.core.$,function(b){var c=a.core.qs(b);return c}),c=b(1);a.qs=c}}),e("app/i18n",[],function(){return function(a){a.core._.extend,a.core.logger,a.core._;a.i18n=a.provider.create(),a.i18n.add("default",{defaultDialogTitle:"�Ի���",windowCloseText:"�ر�",loadingText:"������..."})}}),e("app/attrProvider",[],function(){return function(a){a.core._.extend,a.core.logger,a.core._;a.attrProvider=a.provider.create(),a.attrProvider.add("default",{bind:function(a){},unbind:function(){},create:function(a){return a},get:function(){},set:function(){}}),a.attrProvider.add("querystring",{create:function(b,c){return null==b.getter&&(b.getter=function(b){return a.qs.get(b.sourceKey)}),c.sub("qs-changed",function(a){var d=a[b.sourceKey],e=c.attr(b.name);d!==e&&c.attr(b.name,d)}),b}}),a.attrProvider.add("options",{create:function(a,b){return null==a.getter&&(a.getter=function(a){return b.options[a.sourceKey]}),a}}),a.attrProvider.add("global",{create:function(b,c){return null==b.getter&&(b.getter=function(){return a.data.get(b.sourceKey)}),c.sub("change."+b.sourceKey,function(a){var d=c.attr(b.name);a!==d&&c.attr(b.name,a)}),b}})}}),e("app/templateEngine",[],function(){return function(a){var b=(a.core._.extend,a.core.logger,a.core._);a.templateEngine=a.provider.create(),a.templateEngine.add("default",{options:function(a){return{}},compile:function(a){return function(){return a}}}),a.templateEngine.add("underscore",{options:function(c){return b.extend({lang:a.lang[c.options.langClass]},c.options)},compile:function(a,c){return b.template(a,{variable:"data"})}}),a.templateEngine.add("lodash",{options:function(c){return b.extend({lang:a.lang[c.options.langClass]},c.options)},compile:function(a,c){return b.template(a,{variable:"data"})}})}}),e("app/viewEngine",[],function(){return function(a){a.core._.extend,a.core.logger,a.core._;a.viewEngine=a.provider.create(),a.viewEngine.add("default",{bind:function(a,b,c){},unbind:function(){},create:function(a){return a},bindEvents:function(a,b){},get:function(){},set:function(){}})}}),e("app/view/mixin",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e=c.noop,f={configs:{_mixins:function(){return[]},mixins:e},methods:{_applyMixins:function(){var a=this,c=this._invoke("_mixins"),e=this._invoke("mixins");e=c.concat(e),d.each(e,function(c){d.isFunction(c)?c(a,b):d.each(c,function(b,c){null==a[c]&&(a[c]=b)})})}}};a._extend(f)}}),e("app/view/meta",[],function(){return function(a,b){a._extend({methods:{_getContext:function(){return this.options._source}}})}}),e("app/view/aspect",[],function(){return function(a,b){var c=b.core.$,d=(b.core._,c.noop),e={configs:{aspect:d},methods:b.core.aspect};a._extend(e)}}),e("app/view/lifecycle",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e=c.noop,f={configs:{init:e,_customDestory:e},methods:{initialize:function(a){a||(a={}),this._applyMixins(),this.options=c.extend(!0,{},this._defaults,this.defaults,a),this._setup(a),this.binds.length>0&&(this.binds.unshift(this),d.bindAll.apply(d,this.binds)),this.$el.addClass("ver-view"),this.options._widgetName&&this.$el.addClass(this.options._widgetName.join(" ")),this._invoke("init"),this.trigger("init"),this.options.autoRender&&this.render()},destroy:function(){this._destroy(),this.options.sandbox.log("destroyed")},reset:function(a){this.destroy(),this.stopListening(),a=c.extend({},this.options,a),this.initialize(a)},_setup:function(a){this._invoke("aspect"),this._initProps(a),this._invoke("_listen"),this._invoke("listen"),this._invoke("subscribe"),this._invoke("initAttr")},_destroy:function(){this._invoke("_destroyWindow",!1),this._invoke("_destroyView",!1),this._invoke("_customDestory")}}};a._extend(f)}}),e("app/view/listen",[],function(){return function(a,b){var c=function(){},d=b.core.Events.listenTo,e={subscribe:c,listen:c},f={listenTo:function(a,b,c){var e=this.listenToDelay;if(_.isString(a))return void e.call(this,a,b,c);if(!_.isString(b)){var f=a;c=b;var g=this;return void _.each(f,function(a){g.listenTo(a[0],a[1],c)})}d.call(this,a,b,c)},listenToDelay:function(a,b,c){this._delayEvents.push({name:a,event:b,callback:c}),this.view(a)&&this.listenTo(this.view(a),b,c)},_listen:function(){var a=this;this.listenTo(this,"rendering",function(){this.state.isRendered=!1,this.options.autoCreateSubview&&this._createSubviews()}),this.listenTo(this,"rendered",function(){this.state.isRendered=!0}),this.listenTo(this,"attr-changed",function(a,b){var c=this.attrChanged[a];null==c&&(c=this.attrChanged.defaults),this._invoke(c,!0,b,a)}),_.each(["modelBound","rendered"],function(b){a[b]&&a.listenTo(a,b,function(){this._invoke(b)})})},sub:function(a,b){this.options.sandbox.on(a,b,this,this.cid)},pub:function(){this.options.sandbox.emit.apply(this.options.sandbox,Array.prototype.slice.call(arguments))},unsub:function(){this.options.sandbox.stopListening(this.cid)}};a._extend({configs:e,methods:f})}}),e("app/view/window",[],function(){return function(a,b){function c(a){var b=a.find(".fn-wnd");return 0===b.length?a:b}function d(a,b){if(0!==a.length){var d=c(b.element),e=h.map(a,function(a){var c=g.extend(!0,{},a);return c.options||(c.options={}),c.options.host=c.options.host?d.find(c.options.host):d,c.options.parentWnd=b,c});this.startWidgets(e).done(function(){b.removeLoading()})}}function e(a,b){var d=this,e=c(b.element);h.each(a,function(a){var c=g.extend({},a),f=c.name;c.options=h.extend({host:e,parentWnd:b},c.options);var i=d.view(f,c);i.options.sandbox&&i.$el.addClass(i.options.sandbox.name),i.state.isRendered?b.rendered(d):(i.listenTo(i,"rendered",function(){b.rendered(d)}),i.listenTo(i,"refresh-fail",function(){b.close()})),b.vToBeDestroyed[f]=i})}var f=b.core,g=b.core.$,h=b.core._,i=(f.i18n,{WIDGET:"widget",VIEW:"view"}),j={windowOptions:!1},k={windowEngine:"",defaultWndOptions:function(){return{}}},l={_resetParentWnd:function(){this.options.parentWnd&&this.options.windowOptions&&(this.options.parentWnd.setOptions(this.options.windowOptions),this.options.parentWnd.config.center&&this.options.parentWnd.center())},uniqWindowName:function(){return h.uniqueId("wnd_")},viewWindow:function(a,b,c,d){return this.window(g.extend({name:"wnd_"+a,children:[{type:"view",name:a,initializer:b,options:c}]},d))},widgetWindow:function(a,b,c){return this.window(g.extend({name:"wnd_"+a,children:[{type:"widget",name:a,options:b}]},c))},htmlWindow:function(a,b,c){return this.window(g.extend({options:b,content:a},c))},window:function(a,b){var f=this,j=this._windows;if(h.isString(a))return j[a];if(j[a.name])return j[a.name];null==b&&(b=!0);var k=this._windowProvider().options({name:"",el:null,content:null,center:!0,template:'<div class="fn-wnd fn-wnd-placeholder"><span class="ui-dialog-loading fn-s-loading">'+this._i18n("loadingText")+"</span></div>",destroyedOnClose:!0,children:null,options:{title:this._i18n("defaultDialogTitle")}}),l=this._invoke("defaultWndOptions");a=g.extend(!0,{},k,l,a),""===a.name&&(a.name=f.uniqWindowName()),a.positionTo&&(a.center=!1);var m=g(null==a.el?a.template:a.el),n=h.isString(a.content);n&&c(m).html(a.content);var o=f._windowInstance(m,a,this);if(o.vToBeDestroyed={},o.vLazyLayout=h.debounce(h.bind(function(){this.center()},o),300),a.children){var p=[],q=[];h.each(a.children,function(b){var c=b.type||a.type;c===i.VIEW&&q.push(b),c===i.WIDGET&&p.push(b)}),e.call(this,q,o),d.call(this,p,o)}else o.removeLoading();return o&&(j[a.name]=o),a.center&&(o.center(),g(window).on("resize",o.vLazyLayout)),b&&setTimeout(function(){o.open()},200),o},_destroyWindow:function(a){var b=this;if(null==a)return void h.each(this._windows,function(a,c){b._destroyWindow(c)});var c=this._windows[a],d=c.element,e=this.options.sandbox.app;g.each(c.vToBeDestroyed,function(a,c){b._destroyView(a)}),e.widget.stop(d),g(window).off("resize",c.vLazyLayout),c.destroy?c.destroy():g(c).remove(),delete this._windows[a]},_windowProvider:function(){return b.windowProvider.get(this.windowEngine)},_windowInstance:function(a,b){return this._windowProvider().create(a,b,this)}};a._extendMethod("_setup",function(){this._invoke("_resetParentWnd")}),a._extend({options:j,configs:k,methods:l})}}),e("app/view/attr",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e=c.noop,f={defaultAttrSetup:"init"},g={attrChanged:{},initAttr:e},h={_attrProvider:function(a){return b.attrProvider.get(a)},attr:function(a,b){if(d.isUndefined(b)){if(d.isObject(a)){var c=a;null==c.setup&&(c.setup=this.options.defaultAttrSetup),null==c.sourceKey&&(c.sourceKey=c.name);var e=this;c.source?(c=e._attrProvider(c.source).create(c,e),this.listenToOnce(this,c.setup,function(){var a=this._invoke(c.getter,!0,c);this.attr(c.name,a)})):this.attr(c.name,c.value)}}else this._attributes[a]=b,this.trigger("attr-changed",a,b);return this._attributes[a]}};a._extend({options:f,configs:g,methods:h})}}),e("app/view/action",[],function(){return function(a,b){var c=b.core.$,d=b.core._;a._extendMethod("_setup",function(){this.options.autoAction&&(this.events||(this.events={}),c.extend(this.events,{"click [data-action]":"_actionHandler","click [data-dlg-view]":"_dlgViewHandler","click [data-dlg-widget]":"_dlgWidgetHandler"}))}),a._extend({options:{autoAction:!1},methods:{_actionHandler:function(a,e){a.preventDefault(),e||(e=this);var f=c(a.currentTarget);if(!(f.closest("script").length>0)){var g=f.data().action;g.indexOf("Handler")<0&&(g+="Handler"),e[g]&&e[g](a,b,d,c)}},_getViewTriggerOptions:function(a){var c=a.split("?"),d=c[0],e={};return c[1]&&(e=b.core.util.qsToJSON(c[1])),e._viewName=d,e},_dlgViewHandler:function(a){var d=c(a.currentTarget),e=this._getViewTriggerOptions(d.attr("data-dlg-view")),f=function(a){var c=b.view.ctor(a._viewName);return new c(a)};this.viewWindow(e._viewName,f,e)},_dlgWidgetHandler:function(a){var b=c(a.currentTarget),d=this._getViewTriggerOptions(b.attr("data-dlg-widget"));this.widgetWindow(d._viewName,d)}}})}}),e("app/view/children",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e={activeView:null,autoCreateSubview:!0},f={switchable:[],views:null},g={view:function(a,b){var c;return d.isUndefined(b)?c=this._views[a]:(this._destroyView(a),c=this._createView(b,a),null!=c&&(this._views[a]=c)),c},active:function(a){var b=this;this._activeViewName=d.isUndefined(a)?this._activeViewName:a;var c=this.view(this._activeViewName);d.each(this.switchable,function(a){b.view(a)&&b.view(a).hide()}),c.show(),this.trigger("activeView",this._activeViewName),c.trigger("active")},startWidgets:function(a){return this.options.sandbox.startWidgets(a,null,this.cid)},stopChildren:function(){this.options.sandbox.stopChildren(this.cid)},_createSubviews:function(a){var b=this;a||(a=this.views),a&&(a=d.result(this,"views"),d.each(a,function(a,c){d.isString(a)||b.view(c,a)}),this.options.activeView&&this.active(this.options.activeView))},_viewConfig:function(a){var b=d.result(this,"views");if(a&&b){var c=b[a];return d.isString(c)?null:c}return b},_createView:function(a,e){if(a.cid)return a._name=e,a;var f=a;d.isFunction(a)&&(f=a.apply(this)),d.isString(f.initializer)&&(f.initializer=b.widget.getLocal(f.initializer));var g=b.view.define(f.initializer,!0),h=c.extend({},f.options)||{};if(d.isString(h.host)&&(h.host=this.$(h.host)),h=d.extend({_name:e,_widgetName:f.initializer._widgetName,_source:f.initializer._source,sandbox:this.options.sandbox,host:!h.el&&this.$el},h),null!=h.host&&0===h.host.length)return null;var i=g(h),j=this;return d.each(d.filter(this._delayEvents,function(a){return a.name===e}),function(a){j.listenTo(i,a.event,a.callback)}),i},_destroyView:function(a){var b=this;if(d.isUndefined(a))d.each(this._views,function(a,c){b._destroyView(c)});else{var c=this.view(a);c&&(c.stopChildren&&c.stopChildren(),c.unsub&&c.unsub(),c.destroy&&c.destroy(),c.remove&&c.remove(),c.sandbox&&(c.sandbox=null),this._views[a]=null,delete this._views[a])}}};a._extend({options:e,configs:f,methods:g})}}),e("app/view/render",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e=c.noop,f={_place:0,autoRender:!0},g={template:null,templateEngine:"lodash",templateUrl:null,enhance:e,rendered:e},h={updateEl:function(a,b,d){var e=this.$(a);arguments.length>2?c.get(b,d).done(function(a){e.html(a)}):e.html(b)},render:function(a){return a||(a=this.template),this.templateUrl?this._refresh():(this.options.el&&!a&&(a=d.unescape(this.$el.html())),this._render(a)),this},_html:function(a){this.$el.get(0).innerHTML=a},_templateEngine:function(){var a=this.options.sandbox.app;return a.templateEngine.get(this.templateEngine)},_compileTemplate:function(a){return this._templateEngine().compile(a,this)},_executeTemplate:function(a){var b=this._templateEngine().options(this);return a(b)},_renderTemplate:function(a){var b=d.isFunction(a)?a:this._compileTemplate(a);return this._executeTemplate(b)},_render:function(a,c){var d,e=!!a,f=this.options,g=f.sandbox;if(e&&(d=c?a:this._renderTemplate(a),d&&this._html(d)),this.trigger("rendering"),this.options.host&&this.state.isAppended!==!0){var h=1===f._place?"prependTo":"appendTo";b.widget.isValid(f._page)&&(this.$el[h](this.options.host),this.state.isAppended=!0)}return this._invoke("_rendered"),this.trigger("rendered"),g.log(this.cid+" rendered"),this},_refresh:function(a,b){var e=this;null==a&&(a=this._invoke("templateUrl")),this.state.templateIsLoading=!0,c.get(a,b).done(function(a){e.state.templateIsLoading=!1,d.isString(a)?(e._render(a,!0),e.trigger("refresh")):e.trigger("refresh-fail")}).fail(function(){e.options.parentWnd&&e.options.parentWnd.close()})},_rendered:function(a){},show:function(){var a=this;this.$el.show(!1,function(){a.options.autoResize&&a.resize()})},hide:function(){this.$el.hide(!1)}};a._extend({options:f,configs:g,methods:h})}}),e("app/view/mvvm",[],function(){return function(a,b){var c=b.core.$,d=b.core._,e=c.noop,f={viewEngine:"",bindByBlock:!1,bindWhenStabled:!1},g={staticModel:null,delegateModelEvents:e,modelChanged:{},modelBound:e},h={_createViewModel:function(a){return this._viewEngine().create(a,this)},_bind:function(){var a=this;this.options.bindByBlock?this.$el.find(".data-bind-block").not(this.$el.find(".ver-view .data-bind-block")).each(function(b,d){a._viewEngine().bind(a,c(d),a.model())}):a._viewEngine().bind(a,this.$el,a.model())},_viewEngine:function(){return b.viewEngine.get(this.options.viewEngine)},model:function(a,b){var e=this;if(!d.isUndefined(a)){if(d.isString(a)&&this._viewModel)return null!=b&&this._setModelValue(a,b,this._viewModel),this._getModelValue(a);if(a.toJSON)this._viewModel=a;else{var e=this,f={};this._viewModel=this._createViewModel(c.extend({},f,a))}this._viewEngine().bindEvents(e._viewModel,e),this.delegateModelEvents(this._viewModel),this.trigger("modelInit",this._viewModel),b===!0&&this._bindViewModel()}return this._viewModel},_bindViewModel:function(){var a=this.options.sandbox;!this.options.bindEmptyModel&&c.isEmptyObject(this._viewModel)||(this._bind(),this.$el.hasClass("k-bind-block")||this.$el.addClass("k-bind-block"),this.trigger("modelBound",this._viewModel),a.log(this.cid+" modelBound"))},_getModelValue:function(a,b){return b||(b=this.model()),this._viewEngine().get(b,a)},_setModelValue:function(a,b,c){return c||(c=this.model()),this._viewEngine().set(c,a,b)}};a._extend({options:f,configs:g,methods:h}),a._extendMethod("_setup",function(){null==this.model()&&this.model({})}),a._extendMethod("_listen",function(){var a=this.options.bindWhenStabled?"modelStabled":"rendered";this.listenTo(this,a,function(){this._bindViewModel()})}),a._extendMethod("_destroy",function(){this._viewEngine().unbind(this),this._viewModel=null})}}),e("app/view/_combine",["./mixin","./meta","./aspect","./lifecycle","./listen","./window","./attr","./action","./children","./render","./mvvm"],function(){var a=Array.prototype.slice.call(arguments);return function(b,c){var d=c.core._;d.each(a,function(a){a(b,c)})}}),e("app/view/index",["./_combine"],function(a){return function(b){var c=b.core.$,d=b.core._,e=b.core.classBase,f=d.extend({},e,{defaults:{},_defaults:{lazyTemplate:!1,langClass:null},_initProps:function(){this._name=this.options._name,this.binds=[],this._windows={},this._views={},this._delayEvents=[],this._attributes={},this.state={},this._activeViewName=null},_i18n:function(a){var c=b.i18n.get();return c[a]},url:function(a){return this.options.url[a]},_invoke:function(a,e){var f=d.toArray(arguments),g=f.length>=2?2:1;null==e&&(e=!0),e&&(f=f.concat([b,d,c]));var h=a;return d.isString(a)&&(h=this[a]),d.isFunction(h)?h.apply(this,f.slice(g)):h}});a(f,b),b.view.base=f}}),e("app/view",["./view/index"],function(a){return function(b){var c=b.core.$,d=b.core._,e=(c.noop,{_ctors:{}});e.register=function(a,c){b.view.ctor(a)||(b.view._ctors[a]=c)},e.ctor=function(a,c){return null!=c&&(b.view._ctors[a]=c),b.view._ctors[a]},e.execute=function(a,b){for(var c=a;null!=c&&d.isFunction(c);)c=c(b);return c},e.define=function(a,e,f){d.isBoolean(e)&&null==f&&(f=e,e=[]),null==f&&(f=!1),null==e&&(e=[]);var g;if(d.isObject(a)&&!d.isFunction(a)){var h=c.extend(!0,{},b.view.base),i=a.inherits||h.inherits;i&&(e=e.concat(i(b))),d.each(e,function(a){d.isFunction(a)?a(h,b):c.extend(!0,h,a)}),c.extend(!0,h,a),g=b.core.View.extend(h)}else{if(!a.extend)return a;g=a}return a&&a.name&&b.view.register(a.name,g),f?function(a){return new g(a)}:g},b.view=e,a(b)}}),e("core/widget",[],function(){"use strict";var a=function(a,b,c){var d=c.core,e=d.$,f=b._name,g=c.sandboxes.create(f),h={_name:null,_page:null,_sandboxRef:g._id,_exclusive:!1,sandbox:g};b=e.extend(h,b),a._widgetName&&(b._widgetName=a._widgetName);var i=c.view.execute(c.view.define(a,!0),b);return null==i?(console.error("Widget should return an object. [errorWidget:"+f),null):(i._name=b._name,i.sandbox=g,i.options||(i.options=b),i.$el&&i.$el.addClass(g.name).addClass(d.constant.WIDGET_CLASS).data(d.constant.WIDGET_CLASS,g.name).data(d.constant.WIDGET_TAG,b._tag).data(d.constant.SANDBOX_REF_NAME,g._id),g.getOwner=function(){return c.widget._runningPool[g._id]},g.getHost=g.getOwner,i)};return a}),e("app/widget",["../core/widget"],function(a){"use strict";return function(b){function c(a){return!!b.widget._declarationPool[a]}function d(a){return b.widget._declarationPool[a]}var e=b.core,f=b.core._,g=b.core.$,h=e.util.mapArrayOrSingle,i=e.util.normalizePath,j=e.util.ensureArray,k=b.config,l=e.constant.WIDGET_CLASS,m=e.loader.useGlobalRequire(),n={_declarationPool:{},_runningPool:{},_currBatchList:[],_lastBatchList:[],isLoading:!1};n.getLocal=d,n.register=function(a,c){b.widget._declarationPool[a]=c},n._getPackagesFrom=function(a,c){return null==c&&(c=!0),h(a,function(a){c===!1&&(a=n.normalizeConfig(a));var d=a.name,e=a.options._source,f=b.env.isDebug(),g=b.config.releaseWidgetPath+"/"+d;if(f){var h=b.module.get(e);g=h.resolveLocation(d)}return{name:d,location:i(g),main:"main"}})},n.package=function(a){a||(a=e.getConfig().controls),f.isString(a)&&(a=[a]);var b={packages:n._getPackagesFrom(a,!1)};m.config(b)},n.parseContext=function(a){return b.config.autoParseContext?a.split("-")[0]:null},n.load=function(a,h,i){var j=g.Deferred(),k=[{name:a,options:h}],l=b.widget._getPackagesFrom(k);if(h._name=a,h._page=i,c(a)){var n=d(a);return j.resolve(n,h),j.promise()}var o=f.map(k,function(a){return a.name});return e.loader.require(o,!0,{packages:l}).done(function(a,b){var c=b;f.isArray(c)&&(c=b[0]),j.resolve(c,h)}).fail(function(a){if("timeout"===a.requireType)console&&console.warn&&console.warn("Could not load module "+a.requireModules);else{var b=a.requireModules&&a.requireModules[0];m.undef(b),console&&console.error&&console.error(a)}j.reject()}),j.promise()},n.normalizeConfig=function(a){f.isString(a)&&(a={name:a,options:{}});var c=/([\w|-]+)@?([\w|-]*)(?:=>)?(.*)/,d=c.exec(a.name);return a.name=d[1],a.options._source=a.options._source||d[2]||b.widget.parseContext(a.name)||"default",a.options.host=a.options.host||d[3]||k.widget.defaultHost,a},n.preprocessConfigs=function(a){var b=this;a=f.map(a,function(a){return b.normalizeConfig(a)});var c=f.uniqBy||function(a,b){return f.uniq(a,!1,b)};return c(a,function(a){return a.options&&a.options.el?a.options.el:a.name+a.options.host})},n.start=function(a,c,d){var h=[],i=this;return a=j(a),b.widget.isLoading=!0,a=i.preprocessConfigs(a),n._cacheList(a,d),f.each(a,function(a){var c=a.name,e=a.options||{},f=e.host;if("empty"===c&&n.clear(f,e._exclusive),n._allowLoad(a)){var g=b.widget.load(c,e,d);h.push(g)}}),g.when.apply(g,h).done(function(){var a=arguments;1===h.length&&(a=[arguments]),f.each(a,function(a){var b=a[0],d=a[1];if(n.isValid(d._page)){var f=n.create(b,d);n.clear(d.host,d._exclusive),f&&(n.add(f),c&&c(f),e.mediator.emit("widgetLoaded."+f._name))}}),b.widget.isLoading=!1,e.mediator.emit("widgetsLoaded"),b.emitQueue.empty()})},n.isValid=function(a){return!a||!b.page||b.page.isCurrent(a)},n.isSame=function(a,b){},n.clear=function(a,c){var d=this;if(a){null==c&&(c=!1);var e=f.filter(b.widget._currBatchList,function(b){return b.options.host===a}),h=d.findDom(g(a));f.each(h,function(a){var d=g(a),h=c;if(!c){var i=f.some(e,function(a){var b=d.hasClass(a.name),c=a.options._tag===d.data("verTag");return b&&c});h=!i}h&&b.widget.stop(b.sandboxes.getByEl(d))})}},n._cacheList=function(a,b){b?(n._lastBatchList=n._currBatchList,n._currBatchList=a):n._currBatchList=n._currBatchList.concat(a)},n._allowLoad=function(a){var c=a.options||{},d=a.name;if("empty"===d)return!0;var e=0===g(c.host).find("."+d).length;if(e)return!0;var h=!!f.find(b.widget._lastBatchList,function(b){var c=b.name===a.name,d=b.options._tag===a.options._tag,e=b.options.host===a.options.host,f=b.options.el===a.options.el;return c&&d&&e&&f});return!h},n.add=function(a){n._runningPool[a.options.sandbox._id]=a},n.create=function(c,d){return a(c,d,b)},n.get=function(a){return n._runningPool[a]},n.remove=function(a){b.widget._runningPool[a]=null,delete b.widget._runningPool[a]},n.findDom=function(a){return a.find("."+l)},n.stop=function(a){var c=this;if(null!=a)if(f.isString(a)){var d=a;f.each(b.sandboxes.getByName(d),function(a){b.widget.stop(a)})}else{if(a.type&&"sandbox"===a.type){var e,h=a;if(h.getOwner&&(e=h.getOwner(),e&&e.state.templateIsLoading))return;var i=b.sandboxes.get(h._parent);return i&&i._children.splice(f.findIndex(i._children,function(a){return a.ref===h._id}),1),b.sandboxes.remove(h._id),h.stopChildren(),h.stopListening(),void(e&&(e.destroy&&e.destroy(),e.remove?e.remove():e.$el.remove(),e.options&&(e.options.sandbox=null),e.sandbox=null,b.widget.remove(h._id)))}c.findDom(a).each(function(a,b){c.stop(g(b))});var j=b.sandboxes.getByEl(a);c.stop(j)}},n.recycle=function(){f.each(b.sandboxes._sandboxPool,function(a){if(a.getOwner){var c=a.getOwner();c&&c.$el&&0===c.$el.closest(document.body).length&&b.widget.stop(a)}})},n._unload=function(a){var b;if(m.s){var c=m.s.contexts._.defined;for(b in c)c.hasOwnProperty(b)&&b.indexOf(a)!==-1&&m.undef(b)}},b.widget=n}}),e("app/uiKit",[],function(){return function(a){a.uiKit=a.provider.create(),a.uiKit.add("default",{init:function(a,b){},destroy:function(){},getInstance:function(){}})}}),e("app/_combine",["./provider","./emitQueue","./env","./data","./page","./layout","./module","./sandboxes","./parser","./router","./request","./qs","./i18n","./attrProvider","./templateEngine","./viewEngine","./view","./widget","./uiKit"],function(){var a=Array.prototype.slice.call(arguments);return function(b){b.use(a)}}),e("app/index",["../core/index","../core/application","./_combine"],function(a,b,c){"use strict";return a.createApp=function(d){a.app&&a.app.stop();var e=new b(d);return e.use(c),a.app=e,e.sandbox=e.sandboxes.create(e.name,a.enums.hostType.APP),e.config.global&&(window.__verApp=e),
e},a}),e("veronica",["./app/index"],function(a){"use strict";return a}),e("jquery",function(){return a}),e("underscore",function(){return _}),d("veronica")});
//# sourceMappingURL=veronica.min.js.map